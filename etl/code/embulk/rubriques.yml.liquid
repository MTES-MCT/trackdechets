in:
  type: file
  path_prefix: {{ env.PATH_PREFIX }}
  parser:
    charset: UTF-8
    newline: CRLF
    type: csv
    delimiter: ;
    quote: '"'
    escape: '"'
    trim_if_not_quoted: false
    skip_header_lines: 1
    allow_extra_columns: false
    allow_optional_columns: false
    columns:
    - {name: Numero inspection, type: string}
    - {name: Nom etablissement, type: string}
    - {name: Code postal, type: string}
    - {name: Commune, type: string}
    - {name: Departement, type: string}
    - {name: Regime en vigueur, type: string}
    - {name: Statut Seveso, type: string}
    - {name: Etat d'activite, type: string}
    - {name: Priorite nationale, type: string}
    - {name: IED-MTD, type: string}
    - {name: Rubrique, type: long}
    - {name: Alinea, type: string}
    - {name: Regime IC, type: string}
    - {name: Etat d'activite IC, type: string}
    - {name: Volume, type: string}
    - {name: Unite, type: string}
out:
  type: postgresql
  host: {{ env.POSTGRES_HOST }}
  user: {{ env.POSTGRES_USER }}
  password: {{ env.POSTGRES_PASSWORD }}
  database: {{ env.POSTGRES_DATABASE }}
  table: rubriques
  schema: etl
  options: {loglevel: 2}
  mode: replace
  column_options:
    numero_inspection: {type: VARCHAR(255)}
    nom_etablissement: {type: VARCHAR(255)}
    code_postal: {type: VARCHAR(255)}
    commune: {type: VARCHAR(255)}
    departement: {type: VARCHAR(255)}
    regime: {type: VARCHAR(255)}
    seveso: {type: VARCHAR(255)}
    etat_activite: {type: VARCHAR(255)}
    priorite_nationale: {type: VARCHAR(255)}
    ied_mtd: {type: VARCHAR(255)}
    rubrique: {type: VARCHAR(255)}
    rubrique: {type: VARCHAR(255)}
    alinea: {type: VARCHAR(255)}
    regime_ic: {type: VARCHAR(255)}
    etat_activite_ic: {type: VARCHAR(255)}
    volume: {type: VARCHAR(255)}
    unite: {type: VARCHAR(255)}
filters:
  - type: rename
    columns:
      Numero inspection: numero_inspection
      Nom etablissement: nom_etablissement
      Code postal: code_postal
      Commune: commune
      Departement: departement
      Regime en vigueur: regime
      Statut Seveso: seveso
      Etat d'activite: etat_activite
      Priorite nationale: priorite_nationale
      IED-MTD: ied_mtd
      Rubrique: rubrique
      Alinea: alinea
      Regime IC: regime_ic
      Etat d'activite IC: etat_activite_ic
      Volume: volume
      Unite: unite
