<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>API GraphQL</title>
        <style>
</style>
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
        
        
    </head>
    <body class="vscode-body vscode-light">
        <h1 id="api-graphql">API GraphQL</h1>
<h2 id="conventions-de-code">Conventions de code</h2>
<h3 id="nommage">Nommage</h3>
<ul>
<li>Les queries et mutations sont préfixées avec le nom du type de BSD:
<ul>
<li><code>bsd*</code> pour le bordereau de suivi des déchets dangereux &quot;générique&quot; (CERFA n° 12571*01)</li>
<li><code>bsdDasri*</code> pour le bordereau de suivi des déchets d'activités de soins à risque infectieux</li>
<li><code>bsdVhu*</code> pour le bordereau de suivi des véhicules hors d'usage</li>
<li><code>bsdHfc*</code> pour le bordereau de suivi de déchets fluides frigorigènes (CERFA n° 12497*02)</li>
<li><code>bsdAmiante*</code> pour le bordereau de suivi des déchets dangereux contenant de l'amiante (CERFA n°11861*03)</li>
<li><code>bsdPah*</code> pour le bordereau de suivi de l'élimination des pièces anatomiques humaines (CERFA N° 11350*03)</li>
</ul>
</li>
</ul>
<h4 id="queries">Queries</h4>
<p>Deux types de queries existent pour chaque type de BSD:</p>
<ul>
<li><code>{prefix}</code> pour obtenir un BSD par son identifiant (ex: <code>bsd</code>, <code>bsdDasri</code>, <code>bsdVhu</code>, etc)</li>
<li><code>{prefix}List</code> pour lister les BSD avec possibilité de filtrer et de paginer (ex; <code>bsdList</code>, <code>bsdDasriList</code>, <code>bsdVhuList</code>, etc)</li>
</ul>
<h4 id="mutations">Mutations</h4>
<p>Trois types de mutations existent pour chaque type de BSD:</p>
<ul>
<li><code>{prefix}Create</code> pour la création d'un BSD</li>
<li><code>{prefix}Update</code> pour la mise à jour des informations d'un BSD sélectionné par son identifiant</li>
<li><code>{prefix}Sign</code> pour signer un BSD sélectionné par son identifiant</li>
</ul>
<h3 id="conventions-spécifiques-aux-queries">Conventions spécifiques aux queries</h3>
<p>TODO</p>
<h3 id="pagination">Pagination</h3>
<p>TODO</p>
<h3 id="filtres">Filtres</h3>
<p>Pour filtrer une liste, on utilise l'argument <code>filter</code>. Cette argument est un objet qui peut contenir
différents champs filtrables en fonction du type de BSD.</p>
<pre><code class="language-graphql"><code><div>bsdList(filter: BsdFilter): [Bsd]

input BsdFilter {
  wasteCode: string
  status: FormStatus
  emitterCompanySiret: string
  recipientCompanySiret: string
}
</div></code></code></pre>
<p>Certains champs filtrables sont communs à l'ensemble des BSD:</p>
<ul>
<li>wasteCode</li>
<li>status</li>
<li>emitterCompanySiret</li>
<li>recipientCompanySiret</li>
<li>... // TODO</li>
</ul>
<h4 id="enums">Enums</h4>
<h5 id="match-strict">Match strict</h5>
<pre><code class="language-graphql"><code><div>query {
  bsdList(filter: { status: DRAFT })
} 

</div></code></code></pre>
<h5 id="contains">Contains</h5>
<pre><code class="language-graphql"><code><div>query {
  bsdList(filter: { status_in: [DRAFT, SENT]})
} 

</div></code></code></pre>
<h4 id="texte">Texte</h4>
<h5 id="match-strict-1">Match strict</h5>
<pre><code class="language-graphql"><code><div>query {
  bsdList(filter: { siret: &quot;1234567890&quot;})
} 
</div></code></code></pre>
<h5 id="contains-1">Contains</h5>
<pre><code class="language-graphql"><code><div>query {
  bsdList(filter: { siret_contains: &quot;12345&quot;}) 
} 
</div></code></code></pre>
<h4 id="datetimes">Datetimes</h4>
<h5 id="match-strict-2">Match strict</h5>
<pre><code class="language-graphql"><code><div>query {
  bsdList(filter: { updated: &quot;&lt;date&gt;&quot;})
} 
</div></code></code></pre>
<h5 id="lt-lte-gt-gte">LT, LTE, GT, GTE</h5>
<pre><code class="language-graphql"><code><div>query {
  bsdList(filter: { updated_gt: &quot;&lt;date&gt;&quot;})
} 
</div></code></code></pre>
<pre><code class="language-graphql"><code><div>query {
  bsdList(filter: { updated_lt: &quot;&lt;date&gt;&quot;})
} 
</div></code></code></pre>
<pre><code class="language-graphql"><code><div>query {
  bsdList(filter: { updated_lte: &quot;&lt;date&gt;&quot;})
} 

</div></code></code></pre>
<h3 id="recherche-textuel">Recherche textuel</h3>
<p>Certaines queries acceptent un paramètre permettrant de filtrer les résultats selon des termes.
Bien qu'il s'agisse d'un filtre, celui-ci agit sur différentes colonnes avec un résultat moins déterministe que les filtres classiques.</p>
<pre><code class="language-graphql"><code><div>bsds(terms: String): [Bsd!]!

# Exemple avec des filtres
bsds(terms: String, filter: BsdFilter): [Bsd!]!
</div></code></code></pre>
<h3 id="conventions-spécifiques-aux-mutations">Conventions spécifiques aux mutations</h3>
<h3 id="variables">Variables</h3>
<p>TODO</p>
<h3 id="erreurs">Erreurs</h3>
<p>TODO</p>
<h3 id="validation-pré-action">Validation pré-action</h3>

    </body>
    </html>