"use strict";(self.webpackChunktrackdechets=self.webpackChunktrackdechets||[]).push([[4816],{2710:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"guides/rndts","title":"Ajouter des d\xe9clarations au RNDTS","description":"Les fonctionnalit\xe9s du RNDTS sont d\xe9sormais disponibles depuis l\'application Trackd\xe9chets.","source":"@site/docs/guides/rndts.md","sourceDirName":"guides","slug":"/guides/rndts","permalink":"/guides/rndts","draft":false,"unlisted":false,"editUrl":"https://github.com/MTES-MCT/trackdechets/edit/dev/doc/docs/guides/rndts.md","tags":[],"version":"current","frontMatter":{"title":"Ajouter des d\xe9clarations au RNDTS"}}');var i=s(4848),r=s(8453);const o={title:"Ajouter des d\xe9clarations au RNDTS"},d=void 0,a={},l=[{value:"Principe g\xe9n\xe9raux",id:"principe-g\xe9n\xe9raux",level:2},{value:"Droits utilisateurs",id:"droits-utilisateurs",level:2}];function c(e){const n={code:"code",h2:"h2",li:"li",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Les fonctionnalit\xe9s du RNDTS sont d\xe9sormais disponibles depuis l'application Trackd\xe9chets.\nIl est possible d'injecter des donn\xe9es au registre de 2 mani\xe8res:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"via import de fichier, sur l'interface Trackd\xe9chets"}),"\n",(0,i.jsx)(n.li,{children:"via API"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"C'est sur la deuxi\xe8me option que nous nous concentrons dans ce guide.\nChaque typologie de registre b\xe9n\xe9ficie d'une mutation d\xe9di\xe9e. On retrouve les typologies suivantes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["SSD : ",(0,i.jsx)(n.code,{children:"addToSsdRegistry"})]}),"\n",(0,i.jsxs)(n.li,{children:["D(N)D entrant : ",(0,i.jsx)(n.code,{children:"addToIncomingWasteRegistry"})]}),"\n",(0,i.jsxs)(n.li,{children:["TEXS entrant : ",(0,i.jsx)(n.code,{children:"addToIncomingTexsRegistry"})]}),"\n",(0,i.jsxs)(n.li,{children:["D(N)D sortant : ",(0,i.jsx)(n.code,{children:"addToOutgoingWasteRegistry"})]}),"\n",(0,i.jsxs)(n.li,{children:["TEXS sortant : ",(0,i.jsx)(n.code,{children:"addToOutgoingTexsRegistry"})]}),"\n",(0,i.jsxs)(n.li,{children:["DD transport\xe9 ou collect\xe9 : ",(0,i.jsx)(n.code,{children:"addToTransportedWasteRegistry"})]}),"\n",(0,i.jsxs)(n.li,{children:["DD g\xe9r\xe9 : ",(0,i.jsx)(n.code,{children:"addToManagedWasteRegistry"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Toutes les mutations de registre suivent un fonctionnement similaire. Seules les donn\xe9es attendues varient."}),"\n",(0,i.jsx)(n.h2,{id:"principe-g\xe9n\xe9raux",children:"Principe g\xe9n\xe9raux"}),"\n",(0,i.jsx)(n.p,{children:"Il est possible d'envoyer jusqu'\xe0 1000 d\xe9clarations par appel API. C'est donc un tableau de d\xe9clarations qui est attendu par chaque endpoint.\nChaque d\xe9claration envoy\xe9e est trait\xe9 s\xe9quentiellement et individuellement. En cas d'erreur rencontr\xe9e sur une d\xe9claration, les d\xe9clarations suivantes continueront \xe0 \xeatre trait\xe9es.\nA la fin du traitement de l'ensemble des d\xe9clarations, si des erreurs ont \xe9t\xe9 rencontr\xe9es, l'API retournera un message d'erreur d\xe9till\xe9 pour chaque d\xe9claration en erreur."}),"\n",(0,i.jsxs)(n.p,{children:["A noter qu'il est possible que certaines lignes soient automatiquement ignor\xe9es lors du traitement: si nous rencontrons une ligne qui a identifiant unique (",(0,i.jsx)(n.code,{children:"publicId"}),") d\xe9j\xe0 existant dans la base et que le motif (",(0,i.jsx)(n.code,{children:"reason"}),") est vide, nous ignorons la ligne.\nAttention donc \xe0 bien utiliser des identifiants uniques pour chaque ligne. Si jamais un identifiant venait \xe0 \xeatre r\xe9utilis\xe9, la ligne serait tout simplement ignor\xe9e et aucune erreur ne serait remont\xe9e."]}),"\n",(0,i.jsx)(n.h2,{id:"droits-utilisateurs",children:"Droits utilisateurs"}),"\n",(0,i.jsx)(n.p,{children:"Un import de registre est fait pour le compte d'un \xe9tablissement. Pour faire une d\xe9claration pour cet \xe9tablissement il existe deux possibilit\xe9s:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["appartenir \xe0 l'\xe9tablissement renseign\xe9 dans la colonne ",(0,i.jsx)(n.code,{children:"reportForCompanySiret"})]}),"\n",(0,i.jsxs)(n.li,{children:["appartenir \xe0 l'\xe9tablissement renseign\xe9 dans la colonne ",(0,i.jsx)(n.code,{children:"reportAsCompanySiret"})," et que cet \xe9tablissement ait une d\xe9l\xe9gation pour l'\xe9tablissement renseign\xe9 dans la colonne ",(0,i.jsx)(n.code,{children:"reportForCompanySiret"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Si aucune de ces deux conditions n'est remplie, une erreur sera retourn\xe9e."})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>d});var t=s(6540);const i={},r=t.createContext(i);function o(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);