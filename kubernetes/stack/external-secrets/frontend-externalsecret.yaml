apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: frontend-secrets
  namespace: trackdechets-frontend
  labels:
    app.kubernetes.io/name: frontend-secrets
    app.kubernetes.io/component: secrets
    app.kubernetes.io/part-of: trackdechets
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: frontend-secretstore
    kind: SecretStore
  target:
    name: frontend-secrets
    creationPolicy: Owner
    template:
      type: Opaque
  data:
    # API endpoint - non-sensitive configuration
    - secretKey: API_ENDPOINT
      remoteRef:
        # Secret name in Scaleway Secret Manager
        # Format: name:<secret-name> or path:<secret-path>
        key: name:trackdechets-frontend/api-endpoint

    # Optional: Sentry DSN for frontend error tracking
    - secretKey: SENTRY_DSN
      remoteRef:
        key: name:trackdechets-frontend/sentry-dsn
      # Optional: if the secret doesn't exist, skip it
      # Remove this ExternalSecret entry if you don't use Sentry

  # Alternative: If you store multiple frontend configs in a single JSON secret
  # dataFrom:
  #   - extract:
  #       key: name:trackdechets-frontend/config
  #       # Use gjson syntax to extract specific fields from JSON
  #       # Example: if secret is {"apiEndpoint": "...", "sentryDsn": "..."}
  #       # You would use: gjson syntax or multiple data entries
